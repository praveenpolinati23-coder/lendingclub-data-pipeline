version: 2

vars:
  dq_threshold: 0.8  

models:
  - name: stg_customers
    description: "Standardized customer data loaded from the raw customers CSV (mocked S3 input)."
    columns:
      - name: customer_id
        description: "Unique identifier for each customer."
        tests:
          - not_null
          - unique
      - name: name
        description: "Lowercased and trimmed customer name."
        tests:
          - not_null
      - name: has_loan
        description: "Flag indicating if the customer has an active loan (yes/no)."
        tests:
          - accepted_values:
              values: ['yes', 'no']

  - name: stg_accounts
    description: "Standardized account data loaded from the raw accounts CSV (mocked S3 input)."
    columns:
      - name: account_id
        description: "Unique identifier for the account."
        tests:
          - not_null
          - unique
      - name: customer_id
        description: "Foreign key to customer_id in stg_customers."
        tests:
          - not_null
      - name: balance
        description: "Account balance converted to numeric."
      - name: account_type
        description: "Lowercased and trimmed account type (savings/checking)."
        tests:
          - accepted_values:
              values: ['savings', 'checking']
